syntax = "proto3";

package robot_vision;

message CameraInTagCoords {
  int32 tag_id = 1;
  repeated double mat = 2; // 4x4 matrix, [j*cols+i]
}

message CameraPosition {
  int32 camera_id = 1;
  repeated CameraInTagCoords camera_in_tag_coords = 2; // tag_id can be non-unique
}

message Telemetry {
  // to do...
}

message ReportCameraPositions {
  repeated CameraPosition camera_position = 1;
  repeated Telemetry telemetry = 2;
}

message ClientRequest {
  oneof msg {
    ReportCameraPositions report_camera_positions = 1;
    // future client-to-server messages
  }
}

message SelfDestruct {
  int32 delay_seconds = 1;
}

message ServerRequest {
  oneof msg {
    SelfDestruct self_destruct = 1;
    // future server-to-client messages
  }
}

message GetRobotPositionRequest {

}

message GetRobotPositionResponse {

}

service VisionSystem {
  // Endpoint for camera co-processors to connect to the central unit (opened by Camera unit). 
  rpc OpenControlStream(stream ClientRequest) returns (stream ServerRequest);
  // Gets robot position in World coordinates (called by PoboRIO).
  rpc GetRobotPosition(GetRobotPositionRequest) returns (GetRobotPositionResponse);
}